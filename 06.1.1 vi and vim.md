# Vi/Vim Editor

Vim (Vi IMproved) is a powerful, highly configurable text editor that is standard on most Linux/Unix systems. Understanding Vim is essential for system administration, as configuration files are primarily text based.

**Installation on RHEL**

- **vim minimal**:  Lightweight version with core features (vi command)
- **vim enhanced**:  Full-featured version (vim command)

```bash
# Check if Vim is installed
vim --version
vi --version

# Install vim-enhanced (recommended)
sudo yum install vim-enhanced

# Regular users get vim when typing vi (alias)
# Root/system users can use \vi to bypass alias
```

**Advantagess**
- **Universal Availability**: Installed by default on most Linux servers
- **No GUI Required**: Works perfectly in terminal-only environments
- **Remote Editing**: Ideal for SSH sessions and web console access
- **POSIX Standard**: Part of the vi specification across UNIX-like systems
- **Cross Platform**: Skills transfer to macOS and other operating systems

**Modes of Operation**

```
┌─────────────────┐
│  Command Mode   │ ←── Start here (default)
└─────────────────┘
     ↓ i         ↑ Esc
┌─────────────────┐
│   Insert Mode   │
└─────────────────┘
     
┌─────────────────┐
│  Command Mode   │
└─────────────────┘
     ↓ v/V/Ctrl+V ↑ Esc
┌─────────────────┐
│  Visual Mode    │
└─────────────────┘

┌─────────────────┐
│  Command Mode   │
└─────────────────┘
     ↓ :           ↑ Enter/Esc
┌─────────────────┐
│ Extended Cmd    │
└─────────────────┘
```

Vi/vim operates in several distinct modes: 

**Command Mode**
- For navigation and text manipulation
- Cut, copy, and paste operations
- Press Esc to return to command mode from any other mode

**Insert Mode**
- Press i to enter
- Type text as file content
- Press Esc to exit

**Visual Mode**
For selecting and manipulating blocks of text *(vim only)*
- `v` - Character selection
- `Shift+V` - Line selection
- `Ctrl+V` - Block selection
- Press `v`, `Shift+V`, or `Ctrl+V` again to toggle selection off, OR press `Esc` to return to Command Mode

**Replace Mode**
For overwriting existing text *(vim only)*
- Press `R` to enter Replace Mode
- Type to overwrite existing characters
- Press `Esc` to exit

**Insert Mode Commands**

To enter Insert Mode from Normal Mode: 

| Command | Description |
|---------|-------------|
| `a` | Append text after the current cursor position |
| `i` | Insert text before the current cursor position |
| `A` | Append text at the end of the current line |
| `I` | Insert text at the beginning of the current line |
| `o` | Open a new line below the current line |
| `O` | Open a new line above the current line |
| `s` | Substitute the current character |
| `S` | Substitute the entire current line |

To exit Insert Mode:  Press `ESC` to return to Normal Mode

> Note: `u` (undo) works in Normal mode, not Insert mode.

**Command Mode Operations**

**Cursor Movement**

**Basic Movement**

| Command | Description |
|---------|-------------|
| `h` | Move one character left |
| `l` | Move one character right |
| `j` | Move one line down |
| `k` | Move one line up |

**Line Navigation**

| Command | Description |
|---------|-------------|
| `0` | Move to the beginning of the current line |
| `$` | Move to the end of the current line |
| `^` | Move to the first non-blank character of the line |

**Word Navigation**

| Command | Description |
|---------|-------------|
| `w` | Move one word forward |
| `b` | Move one word backward |
| `e` | Move to the end of the current word |

**Sentence and Paragraph Navigation**

| Command | Description |
|---------|-------------|
| `)` | Move one sentence forward |
| `(` | Move one sentence backward |
| `}` | Move one paragraph forward |
| `{` | Move one paragraph backward |

**File Navigation**

| Command | Description |
|---------|-------------|
| `gg` | Move to the top of the file |
| `G` | Move to the bottom of the file |
| `10G` | Move to line 10 (replace 10 with desired line number) |
| `Ctrl+f` | Page down |
| `Ctrl+b` | Page up |

**Line Numbers**

```bash
:set number    # Display line numbers temporarily
:set nonumber  # Hide line numbers
```

**For permanent line numbers:**

```bash
vim ~/.vimrc      # User-specific configuration

set number        # Add this line

sudo vim /etc/vimrc      # System wide configuration (requires root)
```

**Text Operations**

**Basic Operations Table**

| Operation | Character | Word | Line |
|-----------|-----------|------|------|
| **Delete** | `x` or `dl` | `dw` | `dd` |
| **Copy (Yank)** | `yl` | `yw` | `yy` |
| **Change** | `cl` or `s` | `cw` | `cc` or `S` |

**Common Text Operations**

| Command | Description |
|---------|-------------|
| `yy` | Copy (yank) the current line |
| `5yy` | Copy the next 5 lines |
| `dd` | Delete the current line |
| `5dd` | Delete the next 5 lines |
| `p` | Paste after cursor |
| `P` | Paste before cursor |
| `u` | Undo last change |
| `Ctrl+r` | Redo last undone change |
| `x` | Delete character under cursor |
| `X` | Delete character before cursor |
| `.` | Repeat last change |
| `%` | Jump to matching bracket/parenthesis |

****Ex-Mode Commands

Enter Command line Mode by typing `:` from Normal Mode. 

**Searching Text**

| Command | Description |
|---------|-------------|
| `/text` | Search forward for "text" |
| `?text` | Search backward for "text" |
| `n` | Find next occurrence (same direction as last search) |
| `N` | Find next occurrence (opposite direction) |
| `*` | Search for word under cursor (forward) |
| `#` | Search for word under cursor (backward) |

**Search Options**
```bash
:set hlsearch      # Enable search highlighting
:set nohlsearch    # Disable search highlighting
: noh               # Clear current search highlighting
: set ignorecase    # Case-insensitive search
:set smartcase     # Case-sensitive if uppercase used
```

**Search and Replace**

**Global Replace**

```bash
:%s/old_text/new_text/g     # Replace all occurrences without confirmation
:%s/old_text/new_text/gc    # Replace all occurrences with confirmation
```

**Range Based Replace**

```bash
:10,20s/old_text/new_text/g    # Replace between lines 10-20
:.,+25s/old_text/new_text/g    # Replace in next 25 lines from current position
```

**Explanation of symbols:**
- `%` - Entire file
- `s` - Substitute command
- `g` - Global (all occurrences on each line)
- `c` - Confirm each replacement
- `.` - Current line position

**Save and Exit**

| Command | Description |
|---------|-------------|
| `:w` | Save file (write) |
| `:q` | Quit (only if no changes made) |
| `:wq` | Save and quit |
| `:x` | Save and quit (same as :wq) |
| `ZZ` | Save and quit (Normal mode command) |
| `:q!` | Quit without saving (force quit) |
| `:w!` | Force save (for read-only files) |
| `:wq!` | Force save and quit |
| `:e!` | Reload file, discarding all unsaved changes |

> Note:`:wq! ` forces save and quit, but `:w!` is the correct command for saving read only files.

**Visual Mode**

> **Note:** Visual mode is available only in Vim, not in traditional vi. 

**Character Oriented Visual Mode**
  1. Press `v` to enter character visual mode
  2. Move the cursor to select text character by character
  3. Perform operations

**Line Oriented Visual Mode**
  1. Press `V` (Shift+v) to enter line visual mode
  2. Use arrow keys or `j`/`k` to select multiple lines
  3. Perform operations

**Block Oriented Visual Mode**
  1. Press `Ctrl+v` to enter block visual mode
  2. Select rectangular blocks of text
  3. Useful for editing columnar data

**Visual Mode Operations**

- `y` - Copy (yank) selected text
- `d` - Delete selected text
- `c` - Change (delete and enter insert mode)
- `p` - Paste (after exiting visual mode)
- `u` - Convert to lowercase
- `U` - Convert to uppercase

**File Protection with Passwords**

> Note: Password protection is available only in Vim, not in traditional vi.

**Encrypting a File**

```bash
vim filename
# Add content and press ESC to enter Normal Mode
: X
# Enter encryption key:   [type your password]
# Enter same key again:  [retype password]
: wq
```

**Opening an Encrypted File**

```bash
vim filename
# Need encryption key for filename
# Enter encryption key:  [enter password]
```

**Removing Password Protection**

```bash
vim filename
# Enter encryption key: [enter current password]
: X
# Enter encryption key: [leave blank and press Enter]
# Enter same key again: [leave blank and press Enter]
:wq
```

---

**Crash Recovery**

Vi/vim automatically creates hidden swap files (`.filename.swp`) to protect against data loss. 

**Understanding Swap Files**

```bash
# Open a file
vi myfile.txt

# In another terminal, check for swap file
ls -la                                      # You'll see:  .myfile.txt.swp
```

**Recovering from Crash**

```bash
# Method 1: Use the recovery option when opening
vim filename                                          # vim will detect the swap file and offer recovery options

# Method 2: Recover explicitly from the swap file
vim -r filename

# Method 3: Recover from a specific swap file
vim -r .filename.swp
```

**Cleanup After Recovery**
```bash
# After successful recovery, remove swap file
rm .filename.swp
```

---

# vi vs vim

| **Criterion** | **vi (Visual Editor)** | **vim (Vi IMproved)** |
|---------------|------------------------|------------------------|
| **Origin & Development** | Original editor developed by Bill Joy (1976) for Unix | Enhanced version by Bram Moolenaar (1991), actively maintained |
| **Package Name (RHEL)** | `vim-minimal` | `vim-enhanced` |
| **Command Invocation** | `vi filename` | `vim filename` |
| **POSIX Compliance** | POSIX standard compliant | POSIX compliant + extended features |
| **Installation Size** | Lightweight (~1-2 MB) | Larger (~10+ MB with dependencies) |
| **Default Availability** | Present on virtually all Unix/Linux systems | Requires explicit installation on some systems |
| **Operating Modes** | Command, Insert, Extended Command | Command, Insert, Extended Command, Visual (character/line/block) |
| **Syntax Highlighting** | Not supported | Supported for 200+ file types/languages |
| **Undo Mechanism** | Single-level (toggle undo/redo with `u`) | Multi level unlimited undo (`u`) and redo (`Ctrl+R`) |
| **Visual Selection** | Not available | Character (`v`), Line (`Shift+V`), Block (`Ctrl+V`) modes |
| **Help System** | No built in help | Comprehensive online help (`:help` command) |
| **Window Management** | Single window only | Split windows (`:split`, `:vsplit`) and tabs |
| **Plugin Architecture** | No plugin support | Extensive plugin ecosystem (Vimscript, Python, Lua) |
| **Search Features** | Basic pattern search (`/`, `?`) | Incremental search, highlighting, regex enhancements |
| **Auto completion** | Not available | Keyword completion (`Ctrl+N`, `Ctrl+P`), omni completion |
| **Macro Recording** | Limited capability | Full macro recording and playback (`q` register) |
| **Configuration** | Basic `.exrc` or `.vimrc` options | Extensive `.vimrc` with autocmd, functions, scripting |
| **Diff Mode** | Not supported | Built-in diff mode (`vimdiff`, `:diffthis`) |
| **Mouse Support** | Not supported | Optional mouse support (`:set mouse=a`) |
| **Tutorial System** | No tutorial | Interactive tutorial (`vimtutor` command) |
| **Clipboard Integration** | No system clipboard access | System clipboard integration (`+` and `*` registers) |
| **Performance** | Extremely fast startup (~0.01s) | Slightly slower startup (~0.05s), negligible in practice |
| **Memory Footprint** | Minimal (1-2 MB RAM) | Moderate (5-10 MB RAM baseline) |
| **Scripting Language** | Limited ex commands | Full Vimscript, Python, Perl, Ruby, Lua interfaces |
| **Code Folding** | Not available | Manual and automatic code folding (`:fold`) |
| **Line Numbering** | Not standard | Absolute (`:set number`) and relative (`:set relativenumber`) |
| **Color Schemes** | Monochrome/terminal default | Multiple built in and custom color schemes |
| **Version Information** | `vi --version` (shows minimal features) | `vim --version` (shows extensive feature list with +/- indicators) |
| **Shell Alias Behavior** | Runs actual vi for all users | Regular users (UID≥200) aliased to vim; root uses actual command |
| **Use Cases** | System recovery, minimal environments, emergency editing, embedded systems | Software development, configuration management, daily editing, scripting |
| **Learning Curve** | Moderate (core concepts) | Steep (extensive feature set requires gradual mastery) |
| **Standards Body** | IEEE POSIX. 1 specification | Community driven, backward compatible with POSIX vi |
| **Extensibility** | Very limited | Highly extensible through plugins, scripts, and external tools |
| **Backward Compatibility** | N/A (is the original) | 100% backward compatible with vi commands |
| **Multi file Editing** | Manual switching (`:e filename`) | Buffers, tabs, argument lists (`:args`), sessions |
| **Regular Expressions** | Basic and extended regex | Enhanced regex with very magic mode (`\v`), Perl style options |
| **GUI Version** | Terminal only | GUI versions available (gvim, MacVim) with menus and toolbars |
| **Community & Support** | Historical documentation | Active community, extensive documentation, Stack Overflow support |
| **Academic/Research Use** | Historical study, minimal system requirements | Modern text processing, data manipulation, computational workflows |
